webpackJsonp([9],{"73ZD":function(t,e){},L4nn:function(t,e){},PezH:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=a("zH3I"),r=a.n(n),i=a("qM9z"),o=function(){return function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var a=[],n=!0,r=!1,i=void 0;try{for(var o,s=t[Symbol.iterator]();!(n=(o=s.next()).done)&&(a.push(o.value),!e||a.length!==e);n=!0);}catch(t){r=!0,i=t}finally{try{!n&&s.return&&s.return()}finally{if(r)throw i}}return a}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),s={name:"DateRangeSelect",props:{format:{type:String,default:"YYYY-MM-DD"},minDate:{type:Date,default:function(){return new Date(2020,0,1)}}},data:function(){return{show:!1,color:"#3296FA",defaultDate:[]}},computed:{maxDate:function(){return new Date(this.minDate.getFullYear()+1,11,31)}},created:function(){},deactivated:function(){this.show=!1},methods:{open:function(t){this.show=!0,this.defaultDate=t||[]},close:function(){this.show=!1},onConfirm:function(t){var e=o(t,2),a=e[0],n=e[1];this.$emit("ok",[r()(a).format(this.format),r()(n).format(this.format)]),this.show=!1}}},c=a("W5g0");var l=function(t){a("L4nn")},h=Object(c.a)(s,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("van-popup",{style:{height:"100%",width:"100%"},attrs:{position:"left"},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[t.show?a("div",[a("div",{staticClass:"van-nav-bar__left",on:{click:t.close}},[a("van-icon",{attrs:{name:"arrow-left"}})],1),t._v(" "),a("van-calendar",{attrs:{"default-date":t.defaultDate,"lazy-render":!1,"show-confirm":!1,"min-date":t.minDate,"max-date":t.maxDate,color:t.color,poppable:!1,title:"选择日期",type:"range"},on:{confirm:t.onConfirm},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}})],1):t._e()])},[],!1,l,"data-v-cef31ac8",null).exports,u=a("Z5i5"),f=a("bSIt"),d=a("A29K"),v=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var a=arguments[e];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(t[n]=a[n])}return t};var m={name:"CertList",components:{DateRangeSelect:h,BookSelect:u.a},mixins:[i.a],data:function(){return{current:0,searchForm:(e={bookId:"",certType:"",condition:"",phCurorgid:"",size:20,subIds:[],verifyStatus:"",begCertDate:"",endCertDate:""},t&&(e=Object.assign(e,t)),e),oldSearchFrom:{},filterLoading:!1,list:[],loading:!1,finished:!1,show:!1,filterStatus:"",currentBook:{},minDate:""};var t,e},computed:v({dateRangeShowName:function(){return r()(this.searchForm.begCertDate).format("YYYY年M月D日")+"-"+r()(this.searchForm.endCertDate).format("YYYY年M月D日")}},Object(f.b)(["userBookList"])),created:function(){if(console.log("CertList-render"),0===this.userBookList.length)return d.b.fail("用户无关联账本！"),this.$router.replace("/index/home"),!1;this.currentBook=this.userBookList[0],this.searchForm.begCertDate=r()(this.currentBook.nowPeriod).format("YYYY-MM-DD"),this.searchForm.endCertDate=r()(this.currentBook.nowPeriod).format("YYYY-MM-DD"),this.setBookSearchDate(this.currentBook)},methods:{bookChange:function(t){this.currentBook=t,this.setBookSearchDate(t),this.reQueryList()},openFilter:function(){this.oldSearchFrom=this.$deepClone(this.searchForm),this.show=!0,this.filterLoading=!1},setOldSearchFrom:function(){this.searchForm.condition="",this.searchForm.verifyStatus=""},filterOK:function(){var t=this;this.filterLoading=!0,this.show=!1,this.reQueryList().then(function(){t.filterLoading=!1}).catch(function(e){console.log(e),t.filterLoading=!1})},openDateRangeSelect:function(){this.$refs.dateRangeSelect.open([new Date(r()(this.searchForm.begCertDate).format("YYYY/MM/DD")),new Date(r()(this.searchForm.endCertDate).format("YYYY/MM/DD"))])},dateRangeSelectOk:function(t){this.searchForm.begCertDate=t[0],this.searchForm.endCertDate=t[1],this.reQueryList()},setBookSearchDate:function(t){this.searchForm.begCertDate=r()(t.nowPeriod).startOf("month").format("YYYY-MM-DD"),this.searchForm.endCertDate=r()(t.nowPeriod).endOf("month").format("YYYY-MM-DD");var e=t.enableDate;this.minDate=new Date(e.split("-")[0],e.split("-")[1]-1,e.split("-")[2])},statusChange:function(t){this.searchForm.verifyStatus=t.value},backHandler:function(){this.$router.history.go(-1)},reQueryList:function(){return this.list=[],this.finished=!1,this.queryList(1)},queryList:function(t){var e=this;return this.loading=!0,this.current=t||this.current+1,this.$http.postFormData("villageapp/cert/findCertByCondition",v({},this.searchForm,{bookId:this.currentBook.phid,phCurorgid:this.$commonQueryParam.orgId,current:this.current})).then(function(t){var a=t.data||{},n=a.total;e.list=e.list.concat(a.records),e.loading=!1,e.list.length>=n&&(e.finished=!0)})},toDetail:function(t){this.$router.push({path:"/certDetail",query:{phid:t.phid}})},onLoad:function(){this.queryList()}}};var p=function(t){a("73ZD")},b=Object(c.a)(m,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"page-cert-list"},[a("van-nav-bar",{attrs:{title:"凭证查看","left-arrow":""},on:{"click-left":t.backHandler}}),t._v(" "),a("div",{staticClass:"s-w"},[a("div",{staticClass:"fake-input one"},[a("book-select",{attrs:{"current-book":t.currentBook},on:{change:t.bookChange}})],1),t._v(" "),a("div",{staticClass:"fake-input two",on:{click:t.openDateRangeSelect}},[a("div",{staticClass:"ellipsis-text"},[t._v(t._s(t.dateRangeShowName))])]),t._v(" "),a("div",{staticClass:"fake-input three",on:{click:t.openFilter}},[t._m(0)])]),t._v(" "),a("div",{ref:"scrollView",staticClass:"c-l-w"},[a("van-list",{staticClass:"a-l-l",attrs:{finished:t.finished,"finished-text":"没有更多了"},on:{load:t.onLoad},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},t._l(t.list,function(e){return a("van-cell",{key:e.phid,attrs:{title:e.digest,"is-link":""},on:{click:function(a){return t.toDetail(e)}}},[a("div",{attrs:{slot:"label"},slot:"label"},[a("van-row",[a("van-col",{attrs:{span:"4"}},[a("span",[t._v(t._s(e.certTypeName)+"-"+t._s(e.certNo))])]),t._v(" "),a("van-col",{attrs:{span:"8"}},[a("span",{staticClass:"m-t"},[t._v("¥ "+t._s(t.$formatMoney(e.money)))])])],1)],1)])}),1)],1),t._v(" "),a("van-popup",{style:{height:"100%",width:"85%"},attrs:{position:"right"},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[a("div",{staticClass:"f-w"},[a("div",{staticClass:"s-b"},[a("van-search",{attrs:{placeholder:"请输入凭证号/摘要"},model:{value:t.searchForm.condition,callback:function(e){t.$set(t.searchForm,"condition",e)},expression:"searchForm.condition"}})],1),t._v(" "),a("div",[a("div",{staticClass:"f-t"},[t._v("状态")]),t._v(" "),a("van-row",[a("van-col",{attrs:{span:"8"}},[a("van-button",{staticClass:"f-b-b",class:{"grey-btn":""!==t.searchForm.verifyStatus},attrs:{type:"primary",size:"small",plain:""},on:{click:function(e){return t.statusChange({value:""})}}},[t._v("全部")])],1),t._v(" "),t._l(t.$VERIFY_STATUS_LIST,function(e,n){return a("van-col",{key:n,attrs:{span:"8"}},[a("van-button",{staticClass:"f-b-b",class:{"grey-btn":t.searchForm.verifyStatus!==e.value},attrs:{type:"primary",size:"small",plain:""},on:{click:function(a){return t.statusChange(e)}}},[t._v(t._s(e.label))])],1)})],2)],1),t._v(" "),a("div",{staticClass:"b-b-w"},[a("van-button",{staticClass:"b-b-i",attrs:{type:"default",size:"small"},on:{click:t.setOldSearchFrom}},[t._v("重置")]),t._v(" "),a("van-button",{staticClass:"b-b-i",attrs:{loading:t.filterLoading,type:"primary",size:"small"},on:{click:t.filterOK}},[t._v("确定")])],1)])]),t._v(" "),a("date-range-select",{ref:"dateRangeSelect",attrs:{"min-date":t.minDate},on:{ok:t.dateRangeSelectOk}})],1)},[function(){var t=this.$createElement,e=this._self._c||t;return e("div",[e("i",{staticClass:"iconfont icon-shaixuan"})])}],!1,p,"data-v-9d86bff4",null);e.default=b.exports}});