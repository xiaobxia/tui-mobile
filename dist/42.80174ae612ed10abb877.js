webpackJsonp([42],{Iml9:function(t,a){},mCek:function(t,a,e){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var s=e("zH3I"),n=e.n(s),i=e("wOqC"),o=e("HRnp"),r=e("Z5i5"),l=e("Rz25"),c=e("A29K"),v=e("bSIt"),h=Object.assign||function(t){for(var a=1;a<arguments.length;a++){var e=arguments[a];for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&(t[s]=e[s])}return t};var d={name:"AccountBalance",components:{YearMonthRangeSelect:i.a,BookSelect:r.a,ViewLoading:o.a,BetterPick:l.a},mixins:[],data:function(){return{currentBook:{},searchForm:(a={accountType:0,containNoAcco:0,delCarryCert:0,foreignKey:"人民币",isStand:"0",endSubEncode:"",showAllSubLevel:0,showAssist:0,showHapZero:0,showZero:0,startSubEncode:"",startDate:"",endDate:""},t&&(a=Object.assign(a,t)),a),oldSearchFrom:{},list:[],isFirstTimes:!0,show:!1,sumInfo:{initialDebit:"",initialLender:"",endDebit:"",endLender:""},filterLoading:!1,viewLoading:!1,minDate:""};var t,a},computed:h({dateRangeShowName:function(){return n()(this.searchForm.startDate).format("YYYY年M月")+"-"+n()(this.searchForm.endDate).format("YYYY年M月")}},Object(v.b)(["userBookList"])),created:function(){if(0===this.userBookList.length)return c.b.fail("用户无关联账本！"),this.$router.replace("/index/home"),!1;this.currentBook=this.userBookList[0],this.searchForm.startDate=n()(this.currentBook.nowPeriod).startOf("month").format("YYYY-MM-DD"),this.searchForm.endDate=n()(this.currentBook.nowPeriod).endOf("month").format("YYYY-MM-DD");var t=this.currentBook.enableDate;this.minDate=new Date(t.split("-")[0],t.split("-")[1]-1,t.split("-")[2]),this.queryList()},activated:function(){this.isFirstTimes||this.queryList(),this.isFirstTimes=!1},methods:{bookChange:function(t){this.currentBook=t,this.searchForm.startDate=n()(this.currentBook.nowPeriod).startOf("month").format("YYYY-MM-DD"),this.searchForm.endDate=n()(this.currentBook.nowPeriod).endOf("month").format("YYYY-MM-DD"),this.queryList()},openFilter:function(){this.oldSearchFrom=this.$deepClone(this.searchForm),this.show=!0,this.filterLoading=!1},setOldSearchFrom:function(){this.searchForm.containNoAcco=0,this.searchForm.delCarryCert=0},filterOK:function(){var t=this;this.filterLoading=!0,this.show=!1,this.queryList().then(function(){t.filterLoading=!1}).catch(function(a){console.log(a),t.filterLoading=!1})},openDateRangeSelect:function(){this.$refs.yearMonthRangeSelect.open([new Date(n()(this.searchForm.startDate).format("YYYY/MM/DD")),new Date(n()(this.searchForm.endDate).format("YYYY/MM/DD"))])},dateRangeSelectOk:function(t){console.log(t,"datedatedatedatedate"),this.searchForm.startDate=n()(t[0]).startOf("month").format("YYYY-MM-DD"),this.searchForm.endDate=n()(t[1]).endOf("month").format("YYYY-MM-DD"),this.queryList()},backHandler:function(){this.$router.history.go(-1)},queryList:function(){var t=this;return this.viewLoading=!0,this.$http.postFormData("villageapp/subject/getSubBalanceForm",h({},this.searchForm,{bookId:this.currentBook.phid,phCurorgid:this.$commonQueryParam.phCurorgid})).then(function(a){t.viewLoading=!1,t.list=a.data||[],t.list.length>=1&&(t.sumInfo.initialDebit=t.list[0].initialBalance,t.sumInfo.initialLender=t.list[1].initialBalance,t.sumInfo.endDebit=t.list[0].endBalance,t.sumInfo.endLender=t.list[1].endBalance)}).catch(function(a){console.log(a),t.viewLoading=!1})}}},m=e("W5g0");var u=function(t){e("Iml9")},_=Object(m.a)(d,function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"page-cert-list"},[e("van-nav-bar",{attrs:{title:"科目余额表","left-arrow":""},on:{"click-left":t.backHandler}}),t._v(" "),e("div",{staticClass:"s-w"},[e("div",{staticClass:"fake-input one"},[e("book-select",{attrs:{"current-book":t.currentBook},on:{change:t.bookChange}})],1),t._v(" "),e("div",{staticClass:"fake-input two",on:{click:t.openDateRangeSelect}},[e("div",{staticClass:"ellipsis-text"},[t._v(t._s(t.dateRangeShowName))])]),t._v(" "),e("div",{staticClass:"fake-input three",on:{click:t.openFilter}},[t._m(0)])]),t._v(" "),e("div",{staticClass:"view-loading-wrap"},[t.viewLoading?e("view-loading"):t._e(),t._v(" "),e("div",{staticClass:"c-l-w"},[e("div",{staticClass:"a-b"},[e("div",{staticClass:"title"},[t._v("合计")]),t._v(" "),e("div",{staticClass:"dtl-s"},[e("van-row",[e("van-col",{attrs:{span:"16"}},[e("span",[t._v("借期初余额")])]),t._v(" "),e("van-col",{attrs:{span:"8"}},[e("span",{staticClass:"m-t"},[t._v("¥ "+t._s(t.$formatMoney(t.sumInfo.initialDebit)))])])],1),t._v(" "),e("van-row",[e("van-col",{attrs:{span:"16"}},[e("span",[t._v("贷期初余额")])]),t._v(" "),e("van-col",{attrs:{span:"8"}},[e("span",{staticClass:"m-t"},[t._v("¥ "+t._s(t.$formatMoney(t.sumInfo.initialLender)))])])],1),t._v(" "),e("van-row",[e("van-col",{attrs:{span:"16"}},[e("span",[t._v("借期末余额")])]),t._v(" "),e("van-col",{attrs:{span:"8"}},[e("span",{staticClass:"m-t"},[t._v("¥ "+t._s(t.$formatMoney(t.sumInfo.endDebit)))])])],1),t._v(" "),e("van-row",[e("van-col",{attrs:{span:"16"}},[e("span",[t._v("贷期末余额")])]),t._v(" "),e("van-col",{attrs:{span:"8"}},[e("span",{staticClass:"m-t"},[t._v("¥ "+t._s(t.$formatMoney(t.sumInfo.endDebit)))])])],1)],1)]),t._v(" "),t._l(t.list,function(a,s){return s>=2?e("div",{key:s,staticClass:"a-b"},[e("div",{staticClass:"title"},[t._v(t._s(a.encode+a.name))]),t._v(" "),e("div",{staticClass:"dtl-s"},[e("van-row",[e("van-col",{attrs:{span:"16"}},[e("span",[t._v("期初余额")])]),t._v(" "),e("van-col",{attrs:{span:"8"}},[e("span",{staticClass:"m-t"},[t._v("¥ "+t._s(t.$formatMoney(a.initialBalance)))])])],1),t._v(" "),e("van-row",[e("van-col",{attrs:{span:"16"}},[e("span",[t._v("本期借方")])]),t._v(" "),e("van-col",{attrs:{span:"8"}},[e("span",{staticClass:"m-t"},[t._v("¥ "+t._s(t.$formatMoney(a.debit)))])])],1),t._v(" "),e("van-row",[e("van-col",{attrs:{span:"16"}},[e("span",[t._v("本期贷方")])]),t._v(" "),e("van-col",{attrs:{span:"8"}},[e("span",{staticClass:"m-t"},[t._v("¥ "+t._s(t.$formatMoney(a.lender)))])])],1),t._v(" "),e("van-row",[e("van-col",{attrs:{span:"16"}},[e("span",[t._v("期末余额")])]),t._v(" "),e("van-col",{attrs:{span:"8"}},[e("span",{staticClass:"m-t"},[t._v("¥ "+t._s(t.$formatMoney(a.endBalance)))])])],1)],1)]):t._e()})],2)],1),t._v(" "),e("van-popup",{style:{height:"100%",width:"85%"},attrs:{position:"right"},model:{value:t.show,callback:function(a){t.show=a},expression:"show"}},[e("div",{staticClass:"f-w"},[e("div",[e("better-pick",{attrs:{"form-data":t.searchForm,columns:t.$SHI_FOU_SELECT,"value-key":"showAllSubLevel",title:"展开所有次级"}},[e("van-cell",{attrs:{value:t.$SHI_FOU_LIST[t.searchForm.showAllSubLevel].label,title:"展开所有次级","is-link":"","arrow-direction":"down"}})],1),t._v(" "),e("better-pick",{attrs:{"form-data":t.searchForm,columns:t.$SHI_FOU_SELECT,"value-key":"showAssist",title:"显示辅助核算项"}},[e("van-cell",{attrs:{value:t.$SHI_FOU_LIST[t.searchForm.showAssist].label,title:"显示辅助核算项","is-link":"","arrow-direction":"down"}})],1),t._v(" "),e("better-pick",{attrs:{"form-data":t.searchForm,columns:t.$SHI_FOU_SELECT,"value-key":"containNoAcco",title:"包含未审核凭证"}},[e("van-cell",{attrs:{value:t.$SHI_FOU_LIST[t.searchForm.containNoAcco].label,title:"包含未审核凭证","is-link":"","arrow-direction":"down"}})],1),t._v(" "),e("better-pick",{attrs:{"form-data":t.searchForm,columns:t.$SHI_FOU_SELECT,"value-key":"showZero",title:"余额为0不显示"}},[e("van-cell",{attrs:{value:t.$SHI_FOU_LIST[t.searchForm.showZero].label,title:"余额为0不显示","is-link":"","arrow-direction":"down"}})],1),t._v(" "),e("better-pick",{attrs:{"form-data":t.searchForm,columns:t.$SHI_FOU_SELECT,"value-key":"delCarryCert",title:"剔除结转凭证"}},[e("van-cell",{attrs:{value:t.$SHI_FOU_LIST[t.searchForm.delCarryCert].label,title:"剔除结转凭证","is-link":"","arrow-direction":"down"}})],1)],1),t._v(" "),e("div",{staticClass:"b-b-w"},[e("van-button",{staticClass:"b-b-i",attrs:{type:"default",size:"small"},on:{click:t.setOldSearchFrom}},[t._v("重置")]),t._v(" "),e("van-button",{staticClass:"b-b-i",attrs:{loading:t.filterLoading,type:"primary",size:"small"},on:{click:t.filterOK}},[t._v("确定")])],1)])]),t._v(" "),e("year-month-range-select",{ref:"yearMonthRangeSelect",attrs:{"same-year":!0,format:"YYYY-MM-DD"},on:{ok:t.dateRangeSelectOk}})],1)},[function(){var t=this.$createElement,a=this._self._c||t;return a("div",[a("i",{staticClass:"iconfont icon-shaixuan"})])}],!1,u,"data-v-0bdab3b6",null);a.default=_.exports}});