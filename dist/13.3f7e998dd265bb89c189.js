webpackJsonp([13],{"3dta":function(a,t){},DaLJ:function(a,t){},FgUc:function(a,t,e){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=e("HRnp"),s=e("A29K"),i={name:"OrgSelect",components:{ViewLoading:r.a},props:{type:{type:String,default:"reload"}},data:function(){return{show:!1,searchKey:"",selectList:[],selectListRaw:[],valueList:[],viewLoading:!1}},created:function(){},methods:{searchKeyChange:function(){var a=this;if(this.searchKey){var t=[];this.selectListRaw.forEach(function(e){-1!==e.name.indexOf(a.searchKey)&&t.push(e)}),this.selectList=t}else this.selectList=this.selectListRaw},queryFirstOrgList:function(){var a=this;this.viewLoading=!0,this.$http.get("villageapp/orgNew/findFirstOrg/"+this.$commonQueryParam.phUserId).then(function(t){a.viewLoading=!1,a.selectList=t.data||[],a.selectListRaw=t.data||[]}).catch(function(t){console.log(t),a.viewLoading=!1})},open:function(){this.searchKey="",this.selectList=[],this.selectListRaw=[],this.valueList=[],this.queryFirstOrgList(),this.show=!0},close:function(){this.show=!1},queryChild:function(a){var t=this;return this.viewLoading=!0,this.$http.get("villageapp/orgNew/findSonByPhId",{phid:a.phid}).then(function(a){t.viewLoading=!1,t.selectList=a.data||[],t.selectListRaw=a.data||[]}).catch(function(a){console.log(a),t.viewLoading=!1,t.selectList=[],t.selectListRaw=[]})},backItem:function(a,t){this.searchKey="",this.valueList=this.valueList.slice(0,t+1),this.queryChild(a)},selectItem:function(a){this.searchKey="",this.valueList.push(a),this.queryChild(a)},okHandler:function(){if(0===this.valueList.length)return s.b.fail("请选择组织！"),!1;var a=this.valueList[this.valueList.length-1];"reload"===this.type?(this.$store.dispatch("getUserBooksCache",a.phid),this.$store.dispatch("setOrgInfo",a),this.$emit("ok",a),this.show=!1,window.location.reload()):"value"===this.type&&(this.$store.dispatch("getUserBooksCache",a.phid),this.$emit("ok",a),this.show=!1)}}},o=e("W5g0");var n=function(a){e("3dta")},c=Object(o.a)(i,function(){var a=this,t=a.$createElement,e=a._self._c||t;return e("van-popup",{style:{height:"100%",width:"100%"},attrs:{position:"left"},model:{value:a.show,callback:function(t){a.show=t},expression:"show"}},[e("van-nav-bar",{attrs:{title:"选择组织","left-arrow":""},on:{"click-left":a.close}}),a._v(" "),e("div",{staticClass:"c-t"},[a.viewLoading?e("view-loading"):a._e(),a._v(" "),e("div",{staticClass:"s-b"},[e("van-search",{attrs:{placeholder:"请输入组织名"},on:{change:a.searchKeyChange},model:{value:a.searchKey,callback:function(t){a.searchKey=t},expression:"searchKey"}})],1),a._v(" "),e("div",{staticClass:"tree-b"},[e("div",{staticClass:"b-w"},[e("van-button",{staticClass:"b-b-i",attrs:{type:"primary",size:"mini"},on:{click:a.okHandler}},[a._v("确定")])],1),a._v(" "),e("van-steps",{attrs:{active:a.valueList.length,direction:"vertical","inactive-icon":"checked","active-icon":"circle"}},[a._l(a.valueList,function(t,r){return e("van-step",{key:t.name},[e("div",{on:{click:function(e){return a.backItem(t,r)}}},[a._v(a._s(t.name))])])}),a._v(" "),a.selectList.length>0?e("van-step",[e("div",[a._v("请选择")])]):a._e()],2)],1),a._v(" "),e("div",{staticClass:"org-list"},a._l(a.selectList,function(t){return e("van-cell",{key:t.name,attrs:{title:t.name},on:{click:function(e){return a.selectItem(t)}}})}),1)],1)],1)},[],!1,n,"data-v-284ff4e0",null).exports,l=e("bSIt"),h=Object.assign||function(a){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(a[r]=e[r])}return a};function v(a){var t={payStatus:"",formStatus:"",orgId:"",orgCode:"",orgIdTemp:"",orgName:""};return a&&(t=Object.assign(t,a)),t}var p={name:"IndexApproval",components:{OrgSelect:c},data:function(){return{current:0,list:[],loading:!1,finished:!1,show:!1,filterLoading:!1,preSearchFormCondition:"",hasSearchFormCondition:"",mineSearchFormCondition:"",preSearchFormLocal:v(),hasSearchFormLocal:v(),mineSearchFormLocal:v(),editForm:{},activeName:"/index/approval/pre",BILL_STATUS:{0:{label:"未送审",value:0},1:{label:"未审批",value:1},2:{label:"审批中",value:2},3:{label:"审批通过",value:3},4:{label:"审批不通过",value:4},6:{label:"审批退回(未送审)",value:6}},BILL_STATUS1:{2:{label:"审批中",value:2},3:{label:"审批通过",value:3},4:{label:"审批不通过",value:4},6:{label:"审批退回(未送审)",value:6}}}},computed:h({key:function(){return this.$route.fullPath}},Object(l.b)(["keepaliveNames","preTotal","hasTotal","mineTotal","hasSearchForm","mineSearchForm","preSearchForm"])),created:function(){console.log("approval-render"),this.preSearchFormLocal=h({},v(),this.preSearchForm),this.hasSearchFormLocal=h({},v(),this.hasSearchForm),this.mineSearchFormLocal=h({},v(),this.mineSearchForm),this.activeName=this.$route.path},methods:{openFilter:function(){this.show=!0},openPreFilter:function(){this.show=!0,this.filterLoading=!1},openHasFilter:function(){this.show=!0,this.filterLoading=!1},openMineFilter:function(){this.show=!0,this.filterLoading=!1},setOldSearchFrom:function(){"/index/approval/pre"===this.$route.path&&(this.preSearchFormLocal=v()),"/index/approval/has"===this.$route.path&&(this.hasSearchFormLocal=v()),"/index/approval/mine"===this.$route.path&&(this.mineSearchFormLocal=v())},filterOK:function(){this.show=!1,this.filterLoading=!1,"/index/approval/pre"===this.$route.path&&this.preSearch(),"/index/approval/has"===this.$route.path&&this.hasSearch(),"/index/approval/mine"===this.$route.path&&this.mineSearch()},statusChange:function(a,t,e){a[t]=e},preSearch:function(){""===this.preSearchFormLocal.orgId&&(this.preSearchFormLocal.orgIdTemp="",this.preSearchFormLocal.orgName="",this.preSearchFormLocal.orgCode=""),this.$store.commit("SET_preSearchForm",h({condition:this.preSearchFormCondition},this.preSearchFormLocal))},hasSearch:function(){""===this.hasSearchFormLocal.orgId&&(this.hasSearchFormLocal.orgIdTemp="",this.hasSearchFormLocal.orgName="",this.hasSearchFormLocal.orgCode=""),this.$store.commit("SET_hasSearchForm",h({condition:this.hasSearchFormCondition},this.hasSearchFormLocal))},mineSearch:function(){""===this.mineSearchFormLocal.orgId&&(this.mineSearchFormLocal.orgIdTemp="",this.mineSearchFormLocal.orgName="",this.mineSearchFormLocal.orgCode=""),this.$store.commit("SET_mineSearchForm",h({condition:this.mineSearchFormCondition},this.mineSearchFormLocal))},openOrgSelect:function(a){this.editForm=a,this.$refs.orgSelect.open()},orgSelectOk:function(a){this.editForm.orgId=a.phid,this.editForm.orgIdTemp=a.phid,this.editForm.orgCode=a.encode,this.editForm.orgName=a.name}}};var m=function(a){e("DaLJ")},u=Object(o.a)(p,function(){var a=this,t=a.$createElement,e=a._self._c||t;return e("div",{staticClass:"view-approval"},[e("van-nav-bar",{attrs:{title:"审批中心"}}),a._v(" "),"/index/approval/pre"===a.$route.path?e("div",{staticClass:"s-w"},[e("div",{staticClass:"s-b"},[e("van-search",{attrs:{placeholder:"请输入搜索条件"},on:{search:a.preSearch},model:{value:a.preSearchFormCondition,callback:function(t){a.preSearchFormCondition=t},expression:"preSearchFormCondition"}})],1),a._v(" "),e("div",{staticClass:"fake-input three",on:{click:a.openPreFilter}},[a._m(0)])]):a._e(),a._v(" "),"/index/approval/has"===a.$route.path?e("div",{staticClass:"s-w"},[e("div",{staticClass:"s-b"},[e("van-search",{attrs:{placeholder:"请输入搜索条件"},on:{search:a.hasSearch},model:{value:a.hasSearchFormCondition,callback:function(t){a.hasSearchFormCondition=t},expression:"hasSearchFormCondition"}})],1),a._v(" "),e("div",{staticClass:"fake-input three",on:{click:a.openHasFilter}},[a._m(1)])]):a._e(),a._v(" "),"/index/approval/mine"===a.$route.path?e("div",{staticClass:"s-w"},[e("div",{staticClass:"s-b"},[e("van-search",{attrs:{placeholder:"请输入搜索条件"},on:{search:a.mineSearch},model:{value:a.mineSearchFormCondition,callback:function(t){a.mineSearchFormCondition=t},expression:"mineSearchFormCondition"}})],1),a._v(" "),e("div",{staticClass:"fake-input three",on:{click:a.openMineFilter}},[a._m(2)])]):a._e(),a._v(" "),e("van-tabs",{staticClass:"p-tab-p",attrs:{animated:!0},model:{value:a.activeName,callback:function(t){a.activeName=t},expression:"activeName"}},[e("van-tab",{staticClass:"p-t",attrs:{badge:a.preTotal,title:"待办任务",name:"/index/approval/pre",to:"/index/approval/pre","title-class":"p-t"}}),a._v(" "),e("van-tab",{attrs:{badge:a.hasTotal,title:"已办任务",name:"/index/approval/has",to:"/index/approval/has"}}),a._v(" "),e("van-tab",{attrs:{badge:a.mineTotal,title:"我发起的",name:"/index/approval/mine",to:"/index/approval/mine"}})],1),a._v(" "),e("keep-alive",{attrs:{include:a.keepaliveNames}},[e("router-view",{key:a.key})],1),a._v(" "),e("van-popup",{style:{height:"100%",width:"85%"},attrs:{position:"right"},model:{value:a.show,callback:function(t){a.show=t},expression:"show"}},[e("div",{staticClass:"f-w"},["/index/approval/pre"===a.$route.path?e("div",[e("div",{staticClass:"f-t"},[a._v("组织")]),a._v(" "),e("van-row",[e("van-col",{attrs:{span:"8"}},[e("van-button",{staticClass:"f-b-b",class:{"grey-btn":""!==a.preSearchFormLocal.orgId},attrs:{type:"primary",size:"small",plain:""},on:{click:function(t){return a.statusChange(a.preSearchFormLocal,"orgId","")}}},[a._v("全部")])],1),a._v(" "),a.preSearchFormLocal.orgIdTemp?e("van-col",{attrs:{span:"8"}},[e("van-button",{staticClass:"f-b-b",class:{"grey-btn":a.preSearchFormLocal.orgId!==a.preSearchFormLocal.orgIdTemp},attrs:{type:"primary",size:"small",plain:""},on:{click:function(t){return a.statusChange(a.preSearchFormLocal,"orgId",a.preSearchFormLocal.orgIdTemp)}}},[a._v(a._s(a.preSearchFormLocal.orgName))])],1):a._e(),a._v(" "),e("van-col",{attrs:{span:"8"}},[e("van-button",{staticClass:"f-b-b grey-btn",attrs:{type:"primary",size:"small",plain:""},on:{click:function(t){return a.openOrgSelect(a.preSearchFormLocal)}}},[a._v("选择组织")])],1)],1)],1):a._e(),a._v(" "),"/index/approval/has"===a.$route.path?e("div",[e("div",{staticClass:"f-t"},[a._v("审批状态")]),a._v(" "),e("van-row",a._l(a.BILL_STATUS,function(t,r){return e("van-col",{key:r,attrs:{span:"8"}},[e("van-button",{staticClass:"f-b-b",class:{"grey-btn":a.hasSearchFormLocal.formStatus!==t.value},attrs:{type:"primary",size:"small",plain:""},on:{click:function(e){return a.statusChange(a.hasSearchFormLocal,"formStatus",t.value)}}},[a._v(a._s(t.label))])],1)}),1),a._v(" "),e("div",{staticClass:"f-t"},[a._v("支付状态")]),a._v(" "),e("van-row",a._l(a.$PAY_STATUS,function(t,r){return e("van-col",{key:r,attrs:{span:"8"}},[e("van-button",{staticClass:"f-b-b",class:{"grey-btn":a.hasSearchFormLocal.payStatus!==t.value},attrs:{type:"primary",size:"small",plain:""},on:{click:function(e){return a.statusChange(a.hasSearchFormLocal,"payStatus",t.value)}}},[a._v(a._s(t.label))])],1)}),1),a._v(" "),e("div",{staticClass:"f-t"},[a._v("组织")]),a._v(" "),e("van-row",[e("van-col",{attrs:{span:"8"}},[e("van-button",{staticClass:"f-b-b",class:{"grey-btn":""!==a.hasSearchFormLocal.orgId},attrs:{type:"primary",size:"small",plain:""},on:{click:function(t){return a.statusChange(a.hasSearchFormLocal,"orgId","")}}},[a._v("全部")])],1),a._v(" "),a.hasSearchFormLocal.orgIdTemp?e("van-col",{attrs:{span:"8"}},[e("van-button",{staticClass:"f-b-b",class:{"grey-btn":a.hasSearchFormLocal.orgId!==a.hasSearchFormLocal.orgIdTemp},attrs:{type:"primary",size:"small",plain:""},on:{click:function(t){return a.statusChange(a.hasSearchFormLocal,"orgId",a.hasSearchFormLocal.orgIdTemp)}}},[a._v(a._s(a.hasSearchFormLocal.orgName))])],1):a._e(),a._v(" "),e("van-col",{attrs:{span:"8"}},[e("van-button",{staticClass:"f-b-b grey-btn",attrs:{type:"primary",size:"small",plain:""},on:{click:function(t){return a.openOrgSelect(a.hasSearchFormLocal)}}},[a._v("选择组织")])],1)],1)],1):a._e(),a._v(" "),"/index/approval/mine"===a.$route.path?e("div",[e("div",{staticClass:"f-t"},[a._v("单据状态")]),a._v(" "),e("van-row",a._l(a.BILL_STATUS1,function(t,r){return e("van-col",{key:r,attrs:{span:"8"}},[e("van-button",{staticClass:"f-b-b",class:{"grey-btn":a.mineSearchFormLocal.formStatus!==t.value},attrs:{type:"primary",size:"small",plain:""},on:{click:function(e){return a.statusChange(a.mineSearchFormLocal,"formStatus",t.value)}}},[a._v(a._s(t.label))])],1)}),1),a._v(" "),e("div",{staticClass:"f-t"},[a._v("支付状态")]),a._v(" "),e("van-row",a._l(a.$PAY_STATUS,function(t,r){return e("van-col",{key:r,attrs:{span:"8"}},[e("van-button",{staticClass:"f-b-b",class:{"grey-btn":a.mineSearchFormLocal.payStatus!==t.value},attrs:{type:"primary",size:"small",plain:""},on:{click:function(e){return a.statusChange(a.mineSearchFormLocal,"payStatus",t.value)}}},[a._v(a._s(t.label))])],1)}),1),a._v(" "),e("div",{staticClass:"f-t"},[a._v("组织")]),a._v(" "),e("van-row",[e("van-col",{attrs:{span:"8"}},[e("van-button",{staticClass:"f-b-b",class:{"grey-btn":""!==a.mineSearchFormLocal.orgId},attrs:{type:"primary",size:"small",plain:""},on:{click:function(t){return a.statusChange(a.mineSearchFormLocal,"orgId","")}}},[a._v("全部")])],1),a._v(" "),a.mineSearchFormLocal.orgIdTemp?e("van-col",{attrs:{span:"8"}},[e("van-button",{staticClass:"f-b-b",class:{"grey-btn":a.mineSearchFormLocal.orgId!==a.mineSearchFormLocal.orgIdTemp},attrs:{type:"primary",size:"small",plain:""},on:{click:function(t){return a.statusChange(a.mineSearchFormLocal,"orgId",a.mineSearchFormLocal.orgIdTemp)}}},[a._v(a._s(a.mineSearchFormLocal.orgName))])],1):a._e(),a._v(" "),e("van-col",{attrs:{span:"8"}},[e("van-button",{staticClass:"f-b-b grey-btn",attrs:{type:"primary",size:"small",plain:""},on:{click:function(t){return a.openOrgSelect(a.mineSearchFormLocal)}}},[a._v("选择组织")])],1)],1)],1):a._e(),a._v(" "),e("div",{staticClass:"b-b-w"},[e("van-button",{staticClass:"b-b-i",attrs:{type:"default",size:"small"},on:{click:a.setOldSearchFrom}},[a._v("重置")]),a._v(" "),e("van-button",{staticClass:"b-b-i",attrs:{loading:a.filterLoading,type:"primary",size:"small"},on:{click:a.filterOK}},[a._v("确定")])],1)])]),a._v(" "),e("org-select",{ref:"orgSelect",attrs:{type:"value"},on:{ok:a.orgSelectOk}})],1)},[function(){var a=this.$createElement,t=this._self._c||a;return t("div",[t("i",{staticClass:"iconfont icon-shaixuan"})])},function(){var a=this.$createElement,t=this._self._c||a;return t("div",[t("i",{staticClass:"iconfont icon-shaixuan"})])},function(){var a=this.$createElement,t=this._self._c||a;return t("div",[t("i",{staticClass:"iconfont icon-shaixuan"})])}],!1,m,"data-v-63587a49",null);t.default=u.exports}});