webpackJsonp([7],{"3Mrp":function(t,e){},F2Xw:function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=o("zH3I"),a=o.n(i),n=o("wOqC"),s=o("Z5i5"),r=o("HRnp"),l=o("W5g0");var c=function(t){o("fYeR")},h=Object(l.a)({name:"IncomeDetails",components:{},data:function(){return{show:!1,sumInfo:{},incomeBVOList:[]}},computed:{},created:function(){},deactivated:function(){this.show=!1},methods:{open:function(t){this.sumInfo=t[0],this.incomeBVOList=t,this.show=!0},close:function(){this.show=!1,this.$emit("close")},toPath:function(t){this.$router.push(t)}}},function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("van-popup",{style:{height:"100%",width:"100%"},attrs:{position:"left"},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[o("van-nav-bar",{attrs:{title:"收入明细","left-arrow":""},on:{"click-left":t.close}}),t._v(" "),o("div",{staticClass:"common-view-wrap"},[o("van-row",{staticClass:"common-info-block",attrs:{type:"flex",justify:"space-between"}},[o("div",{staticClass:"ellipsis-text"},[t._v("本期总收入")]),t._v(" "),o("div",[t._v("¥ "+t._s(t.$formatMoney(t.sumInfo.incomeCountAmount)))])]),t._v(" "),o("div",{staticClass:"common-block"},[o("table",{attrs:{width:"100%",cellspacing:"0",cellpadding:"0",border:"2"}},[o("thead",[o("tr",[o("th",[t._v("科目")]),t._v(" "),o("th",[t._v("本期发生额")]),t._v(" "),o("th",[t._v("累计发生额")])])]),t._v(" "),t._l(t.incomeBVOList,function(e,i){return e.incomeSubName?o("tr",{key:i},[o("td",{staticStyle:{"text-align":"center"}},[t._v(t._s(e.incomeSubName))]),t._v(" "),o("td",{staticStyle:{"text-align":"center"}},[t._v(t._s(t.$formatMoney(e.incomeCurrentAmount)))]),t._v(" "),o("td",{staticStyle:{"text-align":"center"}},[t._v(t._s(t.$formatMoney(e.incomeCountAmount)))])]):t._e()})],2)])],1)],1)},[],!1,c,"data-v-2ea5b99b",null).exports;var m=function(t){o("QuN9")},u=Object(l.a)({name:"ExpendDetails",components:{},data:function(){return{show:!1,sumInfo:{},spendingBVOList:[]}},computed:{},created:function(){},deactivated:function(){this.show=!1},methods:{open:function(t){this.sumInfo=t[0],this.spendingBVOList=t,this.show=!0},close:function(){this.show=!1,this.$emit("close")},toPath:function(t){this.$router.push(t)}}},function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("van-popup",{style:{height:"100%",width:"100%"},attrs:{position:"left"},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[o("van-nav-bar",{attrs:{title:"支出明细","left-arrow":""},on:{"click-left":t.close}}),t._v(" "),o("div",{staticClass:"common-view-wrap"},[o("van-row",{staticClass:"common-info-block",attrs:{type:"flex",justify:"space-between"}},[o("div",{staticClass:"ellipsis-text"},[t._v("本期总支出")]),t._v(" "),o("div",[t._v("¥ "+t._s(t.$formatMoney(t.sumInfo.loanCountAmount)))])]),t._v(" "),o("div",{staticClass:"common-block"},[o("table",{attrs:{width:"100%",cellspacing:"0",cellpadding:"0",border:"2"}},[o("thead",[o("tr",[o("th",[t._v("科目")]),t._v(" "),o("th",[t._v("本期发生额")]),t._v(" "),o("th",[t._v("累计发生额")])])]),t._v(" "),t._l(t.spendingBVOList,function(e,i){return e.loanSubName?o("tr",{key:i},[o("td",{staticStyle:{"text-align":"center"}},[t._v(t._s(e.loanSubName))]),t._v(" "),o("td",{staticStyle:{"text-align":"center"}},[t._v(t._s(t.$formatMoney(e.loanCurrentAmount)))]),t._v(" "),o("td",{staticStyle:{"text-align":"center"}},[t._v(t._s(t.$formatMoney(e.loanCountAmount)))])]):t._e()})],2)])],1)],1)},[],!1,m,"data-v-fca3804c",null).exports,d=o("Rz25"),f=o("A29K"),v=o("bSIt"),_=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var o=arguments[e];for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(t[i]=o[i])}return t};var p={name:"IncomeExpendDetail",components:{YearMonthRangeSelect:n.a,BookSelect:s.a,IncomeDetails:h,ExpendDetails:u,ViewLoading:r.a,BetterPick:d.a},data:function(){return{searchForm:(e={monthEnd:"",monthStart:"",isDelUnAudit:0,isDelClose:1,isDelBqfsIsZero:0,isDelQmyeIsZero:0,isDelBqfsZero:0,isDelBqfsCountZero:0,subCode:""},t&&(e=Object.assign(e,t)),e),oldSearchFrom:{},currentBook:{},isFirstTimes:!0,detailData:{},sumDetail:{},incomeBVOList:[],spendingBVOList:[],show:!1,filterLoading:!1,viewLoading:!1,listData:[]};var t,e},computed:_({dateRangeShowName:function(){return a()(this.searchForm.monthStart).format("YYYY年M月")+"-"+a()(this.searchForm.monthEnd).format("YYYY年M月")}},Object(v.b)(["userBookList"])),created:function(){if(0===this.userBookList.length)return f.b.fail("用户无关联账本！"),this.$router.replace("/index/home"),!1;this.currentBook=this.userBookList[0],this.searchForm.monthStart=a()(this.currentBook.nowPeriod).startOf("month").format("YYYY-MM-DD"),this.searchForm.monthEnd=a()(this.currentBook.nowPeriod).endOf("month").format("YYYY-MM-DD"),console.log(this.searchForm.monthStart,this.searchForm.monthStart,"this.searchForm.monthStart1"),this.queryList()},activated:function(){this.isFirstTimes||this.queryList(),this.isFirstTimes=!1},methods:{bookChange:function(t){this.currentBook=t,this.searchForm.monthStart=a()(this.currentBook.nowPeriod).startOf("month").format("YYYY-MM-DD"),this.searchForm.monthEnd=a()(this.currentBook.nowPeriod).endOf("month").format("YYYY-MM-DD"),console.log(this.searchForm.monthStart,this.searchForm.monthStart,"this.searchForm.monthStart2"),this.queryList()},toIncomeDetail:function(){this.$refs.incomeDetails.open(this.listData)},toExpendDetail:function(){this.$refs.expendDetails.open(this.listData)},toPath:function(t){this.$router.push(t)},openFilter:function(){this.oldSearchFrom=this.$deepClone(this.searchForm),this.show=!0,this.filterLoading=!1},setOldSearchFrom:function(){this.searchForm.isDelUnAudit=0,this.searchForm.isDelClose=0},filterOK:function(){var t=this;this.filterLoading=!0,this.show=!1,this.queryList().then(function(){t.filterLoading=!1}).catch(function(e){console.log(e),t.filterLoading=!1})},openDateRangeSelect:function(){this.$refs.yearMonthRangeSelect.open([new Date(a()(this.searchForm.monthStart).format("YYYY/MM/DD")),new Date(a()(this.searchForm.monthEnd).format("YYYY/MM/DD"))])},dateRangeSelectOk:function(t){this.searchForm.monthStart=t[0],this.searchForm.monthEnd=t[1],this.queryList()},backHandler:function(){this.$router.history.go(-1)},queryList:function(){var t=this;return this.viewLoading=!0,this.$http.postFormData("villageapp/financialReport/financialDetailData",_({},this.searchForm,{bookId:this.currentBook.phid,monthStart:a()(this.searchForm.monthStart).format("M"),monthEnd:a()(this.searchForm.monthEnd).format("M"),year:a()(this.searchForm.monthStart).format("YYYY"),date:a()().format("YYYY-MM-DD")})).then(function(e){t.viewLoading=!1;var o=e.data||[];t.sumDetail=o[o.length-1]||{},t.detailData=o[0]||{},t.listData=o}).catch(function(e){console.log(e),t.viewLoading=!1})}}};var w=function(t){o("3Mrp")},D=Object(l.a)(p,function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"page-cert-list"},[o("van-nav-bar",{attrs:{title:"收支明细表","left-arrow":""},on:{"click-left":t.backHandler}}),t._v(" "),o("div",{staticClass:"s-w"},[o("div",{staticClass:"fake-input one"},[o("book-select",{attrs:{"current-book":t.currentBook},on:{change:t.bookChange}})],1),t._v(" "),o("div",{staticClass:"fake-input two",on:{click:t.openDateRangeSelect}},[o("div",{staticClass:"ellipsis-text"},[t._v(t._s(t.dateRangeShowName))])]),t._v(" "),o("div",{staticClass:"fake-input three",on:{click:t.openFilter}},[t._m(0)])]),t._v(" "),o("div",{staticClass:"view-loading-wrap"},[t.viewLoading?o("view-loading"):t._e(),t._v(" "),o("div",{staticClass:"c-l-w"},[o("van-cell",{attrs:{value:"¥ "+t.$formatMoney(t.detailData.incomeCountAmount),title:"本期收入合计","is-link":""},on:{click:t.toIncomeDetail}}),t._v(" "),o("van-cell",{attrs:{value:"¥ "+t.$formatMoney(t.detailData.loanCountAmount),title:"本期支出合计","is-link":""},on:{click:function(e){return t.toExpendDetail()}}}),t._v(" "),o("van-cell",{staticClass:"sum-cell",attrs:{value:"¥ "+t.$formatMoney(t.sumDetail.loanCountAmount),"is-link":"",title:"收支结余"}})],1)],1),t._v(" "),o("van-popup",{style:{height:"100%",width:"85%"},attrs:{position:"right"},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[o("div",{staticClass:"f-w"},[o("div",[o("better-pick",{attrs:{"form-data":t.searchForm,columns:t.$SHI_FOU_SELECT,"value-key":"isDelUnAudit",title:"剔除未审核凭证"}},[o("van-cell",{attrs:{value:t.$SHI_FOU_LIST[t.searchForm.isDelUnAudit].label,title:"剔除未审核凭证","is-link":"","arrow-direction":"down"}})],1),t._v(" "),o("better-pick",{attrs:{"form-data":t.searchForm,columns:t.$SHI_FOU_SELECT,"value-key":"isDelClose",title:"剔除结转凭证"}},[o("van-cell",{attrs:{value:t.$SHI_FOU_LIST[t.searchForm.isDelClose].label,title:"剔除结转凭证","is-link":"","arrow-direction":"down"}})],1),t._v(" "),o("better-pick",{attrs:{"form-data":t.searchForm,columns:t.$SHI_FOU_SELECT,"value-key":"isDelBqfsZero",title:"剔除本期发生额为0"}},[o("van-cell",{staticClass:"vancell",staticStyle:{"min-width":"70%"},attrs:{value:t.$SHI_FOU_LIST[t.searchForm.isDelBqfsZero].label,title:"剔除本期发生额为0","is-link":"","arrow-direction":"down"}})],1),t._v(" "),o("better-pick",{attrs:{"form-data":t.searchForm,columns:t.$SHI_FOU_SELECT,"value-key":"isDelBqfsCountZero",title:"剔除本期累计发生额为0"}},[o("van-cell",{staticClass:"vancell",staticStyle:{"min-width":"70%"},attrs:{value:t.$SHI_FOU_LIST[t.searchForm.isDelBqfsCountZero].label,title:"剔除本期累计发生额为0","is-link":"","arrow-direction":"down"}})],1)],1),t._v(" "),o("div",{staticClass:"b-b-w"},[o("van-button",{staticClass:"b-b-i",attrs:{type:"default",size:"small"},on:{click:t.setOldSearchFrom}},[t._v("重置")]),t._v(" "),o("van-button",{staticClass:"b-b-i",attrs:{loading:t.filterLoading,type:"primary",size:"small"},on:{click:t.filterOK}},[t._v("确定")])],1)])]),t._v(" "),o("year-month-range-select",{ref:"yearMonthRangeSelect",attrs:{"same-year":!0,format:"YYYY-MM-DD"},on:{ok:t.dateRangeSelectOk}}),t._v(" "),o("income-details",{ref:"incomeDetails"}),t._v(" "),o("expend-details",{ref:"expendDetails"})],1)},[function(){var t=this.$createElement,e=this._self._c||t;return e("div",[e("i",{staticClass:"iconfont icon-shaixuan"})])}],!1,w,"data-v-6b40dc16",null);e.default=D.exports},QuN9:function(t,e){},fYeR:function(t,e){}});